<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>json Ex1</title>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
</head>

<body>
  <h2>json 데이터 불러오기</h2>
  <ul id="my_data">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
  </ul>
  <h2>카카오 검색 결과</h2>
  <ul id="kakao">
    <li></li>
    </li>
    <li></li>
    <li></li>
    <li></li>
  </ul>

  <h3><a href="kakaoAPIEx2.html">무한 스크롤 검색 가기</a></h3>
<script>
  /* JSON
    이름과 값을 쌍으로 사용 
    자료는 콤마로 구분
    객체는 {}로
    배열은 []로
    이름과 값엔 반드시 "" 안에 작성
  */
  // 내가 작성한 json 데이터 불러오기
  // jQuery 방식으로 ajax 사용. https://api.jquery.com/jquery.ajax
  $.ajax({
    url: "jsonEx1.json",
    dataType: "json",
    success : function(data){
      if(data.length> 0) {
        for(let i in data) {
          let tags = data[i].tags;
          let text = data[i].text;
          let url = data[i].url;
          console.log(text);
          // $("#my_data li").eq(i).append("<img src="+ data[i].url + ">"); 
          // $("#my_data li").eq(i).append("<p>"+ data[i].tags + "</p>");   
          $("#my_data li").eq(i).append("<img src="+ data[i].url + "><p>" + data[i].tags + "</p>"); 
        }
      }
    }
  });
  
  $.ajax({
      method: "GET",
      url: "https://dapi.kakao.com/v3/search/book?target=title",// 전송 주소
      data: { query: "가을" },// 보낼 데이터
      headers: { Authorization: "KakaoAK f993f7c41ef0998b0d68923a7eaedb6b" }// 내 API key KakaoAK로 시작
    })
      .done(function (msg) {// 응답이 오면 처리하는 코드
        console.log(msg);
        let kakao = $('#kakao');
        for (let i = 0; i < 3; i++) {//3개만 출력

          $("#kakao li").eq(i).append("<a href='" + msg.documents[i].url + "'>" + msg.documents[i].title + "</a>");
          $("#kakao li").eq(i).append("<strong>저자:</strong> " + msg.documents[i].authors);

          let str = msg.documents[i].contents;
          str = str.substring(0, 101);//101번째 글자에서 자름

          $('#kakao li').eq(i).append("<p>" + str + "</p>");
        }
      });

</script>
</body>
</html>